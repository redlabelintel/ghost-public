<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO Command Center</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: #fff;
            color: #000;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .online { background: #000; }
        .offline { background: #999; }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            border: 1px solid #333;
            padding: 15px;
        }
        
        .panel h3 {
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
            margin-bottom: 10px;
            font-size: 12px;
            text-transform: uppercase;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        button {
            background: #fff;
            color: #000;
            border: 1px solid #333;
            padding: 8px 12px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
        }
        
        button:hover {
            background: #f0f0f0;
            border-color: #000;
        }
        
        .emergency {
            border-color: #000;
            font-weight: bold;
            background: #000;
            color: #fff;
        }
        
        .list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .list-item {
            padding: 5px 0;
            border-bottom: 1px solid #ddd;
            font-size: 11px;
            display: flex;
            justify-content: space-between;
        }
        
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CEO COMMAND CENTER</h1>
            <span class="status online" id="status"></span>
            <span id="status-text">ONLINE</span>
            <span style="float: right; font-size: 12px;" id="timestamp">--:--:--</span>
        </div>

        <div class="grid">
            <!-- System Overview -->
            <div class="panel">
                <h3>System Status</h3>
                <div class="metric">
                    <span>Active Sessions</span>
                    <span id="session-count">--</span>
                </div>
                <div class="metric">
                    <span>Daily Cost</span>
                    <span id="daily-cost">$--</span>
                </div>
                <div class="metric">
                    <span>API Health</span>
                    <span id="api-health">--</span>
                </div>
                <div class="metric">
                    <span>Uptime</span>
                    <span id="uptime">--</span>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="panel">
                <h3>Executive Controls</h3>
                <div class="controls">
                    <button class="emergency" onclick="emergencyPanic()">
                        [PANIC] EMERGENCY STOP
                    </button>
                    <button onclick="killExpensive()">
                        [KILL] EXPENSIVE SESSIONS
                    </button>
                    <button onclick="enforceLimits()">
                        [ENFORCE] BUDGET LIMITS
                    </button>
                    <button onclick="refreshStatus()">
                        [REFRESH] STATUS
                    </button>
                </div>
            </div>

            <!-- Active Sessions -->
            <div class="panel">
                <h3>Active Sessions</h3>
                <div class="list" id="sessions-list">
                    <div class="list-item">Loading sessions...</div>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="panel">
                <h3>Quick Access</h3>
                <div class="list">
                    <div class="list-item">
                        <span>Ghost Repo</span>
                        <a href="https://github.com/redlabelintel/ghost" target="_blank" style="color: #000;">[OPEN]</a>
                    </div>
                    <div class="list-item">
                        <span>Memory Files</span>
                        <button onclick="openMemory()" style="padding: 2px 6px; font-size: 10px;">[VIEW]</button>
                    </div>
                    <div class="list-item">
                        <span>Projects</span>
                        <button onclick="openProjects()" style="padding: 2px 6px; font-size: 10px;">[VIEW]</button>
                    </div>
                    <div class="list-item">
                        <span>Meeting Notes</span>
                        <button onclick="openMeetings()" style="padding: 2px 6px; font-size: 10px;">[VIEW]</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Log Output -->
        <div class="panel">
            <h3>System Log</h3>
            <div id="log" style="font-size: 11px; color: #666; max-height: 150px; overflow-y: auto;">
                System initialized...<br>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let apiStatus = false;
        let sessionData = [];

        // Logging function
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // API communication
        async function apiCall(endpoint, options = {}) {
            try {
                const response = await fetch(`http://100.76.103.90:3001/api${endpoint}`, {
                    method: options.method || 'GET',
                    headers: { 'Content-Type': 'application/json' },
                    body: options.body ? JSON.stringify(options.body) : null
                });
                const result = await response.json();
                log(`API ${endpoint}: ${result.success !== false ? 'SUCCESS' : 'FAILED'}`);
                return result;
            } catch (error) {
                log(`API ${endpoint}: ERROR - ${error.message}`);
                return { success: false, error: error.message };
            }
        }

        // Update status
        async function updateStatus() {
            const health = await apiCall('/health');
            
            if (health.status === 'operational') {
                apiStatus = true;
                document.getElementById('status').className = 'status online';
                document.getElementById('status-text').textContent = 'ONLINE';
                document.getElementById('api-health').textContent = 'OPERATIONAL';
            } else {
                apiStatus = false;
                document.getElementById('status').className = 'status offline';
                document.getElementById('status-text').textContent = 'OFFLINE';
                document.getElementById('api-health').textContent = 'ERROR';
            }
            
            document.getElementById('timestamp').textContent = new Date().toLocaleTimeString();
        }

        // Load session data
        async function loadSessions() {
            const sessions = await apiCall('/sessions/list');
            if (sessions.success) {
                sessionData = sessions.sessions || [];
                document.getElementById('session-count').textContent = sessionData.length;
                
                const sessionsList = document.getElementById('sessions-list');
                if (sessionData.length > 0) {
                    sessionsList.innerHTML = sessionData.slice(0, 10).map((session, idx) => `
                        <div class="list-item">
                            <span>${session.id || 'Session ' + (idx + 1)}</span>
                            <span>${session.cost || '$0.00'}</span>
                        </div>
                    `).join('');
                } else {
                    sessionsList.innerHTML = '<div class="list-item">No sessions found</div>';
                }
            }
        }

        // Emergency functions
        async function emergencyPanic() {
            if (!confirm('EMERGENCY PANIC: This will pause all non-critical operations. Continue?')) return;
            
            log('EMERGENCY PANIC INITIATED');
            const result = await apiCall('/emergency/panic', { method: 'POST' });
            
            if (result.success) {
                log('EMERGENCY PROTOCOLS ACTIVATED');
            } else {
                log('EMERGENCY PANIC FAILED: ' + (result.error || 'Unknown error'));
            }
        }

        async function killExpensive() {
            if (!confirm('Kill all sessions costing more than $10?')) return;
            
            log('Killing expensive sessions...');
            const result = await apiCall('/sessions/kill-expensive', { 
                method: 'POST',
                body: { threshold: 10.0 }
            });
            
            if (result.success) {
                log(`Killed ${result.killedCount || 0} expensive sessions`);
                loadSessions();
            }
        }

        async function enforceLimits() {
            log('Enforcing budget limits...');
            const result = await apiCall('/financial/enforce-limits', { method: 'POST' });
            
            if (result.success) {
                log('Budget limits enforced');
            }
        }

        function refreshStatus() {
            log('Refreshing status...');
            updateStatus();
            loadSessions();
        }

        // Quick access functions
        function openMemory() {
            window.open('https://github.com/redlabelintel/ghost/tree/main/memory', '_blank');
        }

        function openProjects() {
            window.open('https://github.com/redlabelintel/ghost/tree/main/projects', '_blank');
        }

        function openMeetings() {
            window.open('https://github.com/redlabelintel/ghost/tree/main/agent-standups/meetings', '_blank');
        }

        // Initialize
        function init() {
            log('CEO Command Center initialized');
            updateStatus();
            loadSessions();
            
            // Auto-refresh every 30 seconds
            setInterval(() => {
                updateStatus();
                loadSessions();
            }, 30000);
        }

        // Start the system
        init();
    </script>
</body>
</html>