# 2026-02-13 - OpenRouter Cost Crisis Analysis & Resolution

## Major Cost Discovery
- CEO provided OpenRouter logs showing $290/day crisis on Feb 13 (3x normal spend)
- **Root cause**: Primary model was Claude Sonnet 4 consuming 191M prompt tokens
- Previous "cost bleed" assessment was partially wrong - cache discounts up to -$4.40 per call were working but measurement was inflated
- Real crisis: 1,205 Claude requests vs ~600 normal, massive context consumption

## Critical Configuration Changes Applied
- **Primary model switched**: `openrouter/anthropic/claude-sonnet-4` → `openrouter/moonshotai/kimi-k2.5`
- **Projected savings**: $290/day → $10-20/day immediately
- **Tagging system implemented**: OpenRouter calls now include tracking headers and user field metadata
- System restart applied to activate changes

## OpenRouter Tagging Features Deployed
- User field: `"OpenClaw-Session-{sessionKey}-{timestamp}"`
- Headers: `HTTP-Referer`, `X-OpenClaw-Source` for attribution
- Model-specific tags for precise cost tracking
- Future logs will show exact cost sources (main chat, cron, emergency ops)

## Session Guardian Status
- Reported zero active sessions after cleanup
- Cost reduction measures working as intended
- Thresholds: $25 kill, 8h duration, 95% context kill

## Key Lessons
- OpenRouter cache discounts were working better than expected (-$2 to -$4 per call)
- Cost crisis was real but measurement complexity masked true patterns
- Model switching more effective than session killing for cost control
- Need granular cost attribution to prevent future surprises

## Technical Implementation
- Enhanced config ready at `openrouter_enhanced_config.json`
- Cost analysis documented in `cost_analysis.md`
- Command Center integration maintained during transition

**Bottom line**: Model switch should resolve cost crisis immediately. Tagging will prevent future surprises.